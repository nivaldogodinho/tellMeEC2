import boto3
import csv

ec2 = boto3.resource('ec2')

# creates the csv file
with open('ec2description.csv', 'w', encoding='UTF8', newline='') as f:
    writer = csv.writer(f)

    # creates the header
    header = ['InstanceID', 'State', 'InstanceType', 'SG_ID', 'SG_Name', 'SG_Inbound/Outbound', ]
   
    # write the header
    writer.writerow(header)

    # collect the data for writing to csv file
    for instance in ec2.instances.all():
        print('=======PROCESSANDO=========')
        
        #creates the header
        data = [instance.id, instance.state['Name'], instance.instance_type, instance.security_groups[0]['GroupId'], instance.security_groups[0]['GroupName']]

        # write the data to csv file
        writer.writerow(data)


